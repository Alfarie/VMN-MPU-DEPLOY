import express from 'express';
import socketIO from 'socket.io';
import * as http from 'http';
import path from 'path';
import jsoncsv from 'express-json-csv';
import AuthRouter from './router/authRouter';
import ControlRouter from './router/controlRouter';
import LoggerRouter from './router/loggerRouter';
import WifiRouter from './router/wifiRouter';
import SettingRouter from './router/settingRouter';
import VmnOperationRouter from './router/vmn-operation';
import VmnLoggerRouter from './router/vmnLoggerRouter';
var app = express();
var secret = 'ThisIsSecretMessageIntelAgro';
app.set('superSecret', secret);
var cors = require('cors');
app.use(cors());
jsoncsv(app);
var bodyParser = require('body-parser');
app.use(bodyParser.json());
app.use(express.urlencoded({
    extended: true
}));
var root = path.join(path.resolve(__dirname, '../../../../dist/'));
app.use(express.static(root));
export class WebService {
    constructor() {
        this.port = 3000;
        this.mountRoute();
        this.http = new http.Server(app);
        this.io = socketIO(this.http);
        this.http.listen(this.port, (err) => {
            if (err)
                console.log(err);
            console.log('[Info] Listening on port:', this.port);
        });
    }
    getIO() {
        return this.io;
    }
    mountRoute() {
        const authRouter = new AuthRouter();
        const controlRouter = new ControlRouter();
        const loggerRouter = new LoggerRouter();
        const wifiRouter = new WifiRouter();
        const settingRouter = new SettingRouter();
        const vmnOperationRouter = new VmnOperationRouter();
        const vmnLoggerRouter = new VmnLoggerRouter();
        app.use('/auth', authRouter.getRouter());
        app.use('/control', controlRouter.getRouter());
        app.use('/logger', loggerRouter.getRouter());
        app.use('/vmn-logger', vmnLoggerRouter.getRouter());
        app.use('/wifi', wifiRouter.getRouter());
        app.use('/setting', settingRouter.getRouter());
        app.use('/operation', vmnOperationRouter.getRouter());
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2Vic2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy90eXBlcy93cy93ZWJzZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sT0FBTyxNQUFNLFNBQVMsQ0FBQztBQUc5QixPQUFPLFFBQVEsTUFBTSxXQUFXLENBQUE7QUFDaEMsT0FBTyxLQUFLLElBQUksTUFBTSxNQUFNLENBQUE7QUFDNUIsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFBO0FBQ3ZCLE9BQU8sT0FBTyxNQUFNLGtCQUFrQixDQUFBO0FBQ3RDLE9BQU8sVUFBVSxNQUFNLHFCQUFxQixDQUFBO0FBQzVDLE9BQU8sYUFBYSxNQUFNLHdCQUF3QixDQUFBO0FBQ2xELE9BQU8sWUFBWSxNQUFNLHVCQUF1QixDQUFBO0FBQ2hELE9BQU8sVUFBVSxNQUFNLHFCQUFxQixDQUFBO0FBQzVDLE9BQU8sYUFBYSxNQUFNLHdCQUF3QixDQUFBO0FBQ2xELE9BQU8sa0JBQWtCLE1BQU0sd0JBQXdCLENBQUE7QUFDdkQsT0FBTyxlQUFlLE1BQU0sMEJBQTBCLENBQUE7QUFFdEQsSUFBSSxHQUFHLEdBQUcsT0FBTyxFQUFFLENBQUE7QUFDbkIsSUFBSSxNQUFNLEdBQUcsOEJBQThCLENBQUE7QUFDM0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUE7QUFFOUIsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzNCLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNoQixPQUFPLENBQUMsR0FBRyxDQUFDLENBQUE7QUFDWixJQUFJLFVBQVUsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDdkMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUMzQixHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7SUFDdkIsUUFBUSxFQUFFLElBQUk7Q0FDakIsQ0FBQyxDQUFDLENBQUM7QUFFSixJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLG1CQUFtQixDQUFDLENBQUMsQ0FBQztBQUNuRSxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUc5QixNQUFNLE9BQU8sVUFBVTtJQUluQjtRQUhBLFNBQUksR0FBVSxJQUFJLENBQUE7UUFJZCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFFbEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDaEMsSUFBSSxDQUFDLEVBQUUsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO1FBRzdCLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEVBQUMsRUFBRTtZQUNoQyxJQUFHLEdBQUc7Z0JBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtZQUN4QixPQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUN0RCxDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFFTSxLQUFLO1FBQ1IsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFBO0lBQ2xCLENBQUM7SUFFTyxVQUFVO1FBQ2QsTUFBTSxVQUFVLEdBQUcsSUFBSSxVQUFVLEVBQUUsQ0FBQTtRQUNuQyxNQUFNLGFBQWEsR0FBRyxJQUFJLGFBQWEsRUFBRSxDQUFBO1FBQ3pDLE1BQU0sWUFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUE7UUFDdkMsTUFBTSxVQUFVLEdBQUcsSUFBSSxVQUFVLEVBQUUsQ0FBQTtRQUNuQyxNQUFNLGFBQWEsR0FBSSxJQUFJLGFBQWEsRUFBRSxDQUFBO1FBQzFDLE1BQU0sa0JBQWtCLEdBQUksSUFBSSxrQkFBa0IsRUFBRSxDQUFBO1FBQ3BELE1BQU0sZUFBZSxHQUFJLElBQUksZUFBZSxFQUFFLENBQUE7UUFDOUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDekMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDL0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDN0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsZUFBZSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDcEQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDekMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDL0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsa0JBQWtCLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztJQUMxRCxDQUFDO0NBQ0oifQ==